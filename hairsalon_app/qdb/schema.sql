DROP TABLE SALON_REPORT;

DROP TABLE SALON_APPOINTMENT;

DROP TABLE SALON_SERVICE;

DROP TABLE SALON_USER;

-- Create table for salon_professional
CREATE TABLE SALON_USER (
    USER_ID NUMBER GENERATED BY DEFAULT AS IDENTITY,
    IS_ACTIVE NUMBER(1) DEFAULT(0),
    STATUS NUMBER(1) DEFAULT(0), --flagged or warned.
    USER_TYPE VARCHAR2(15) DEFAULT ('client'), --client, professional, admin_user, admin_appoint, or admin_super.
    USERNAME VARCHAR2(30) NOT NULL UNIQUE,
    FULL_NAME VARCHAR2(100) DEFAULT NULL,
    EMAIL VARCHAR2(120) NOT NULL,
    USER_IMAGE VARCHAR2(30),
    PASSWORD_HASHED VARCHAR2(80) NOT NULL,
    PHONE_NUMBER VARCHAR2(80) NOT NULL,
    ADDRESS VARCHAR2(100) DEFAULT NULL,
    AGE NUMBER(3) NOT NULL,
    PAY_RATE DECIMAL(5, 2) DEFAULT(NULL),
    SPECIALTY VARCHAR2(15) DEFAULT(NULL),
    CONSTRAINT USER_PK PRIMARY KEY (USER_ID)
);

-- Create table for salon_service
CREATE TABLE SALON_SERVICE (
    SERVICE_ID NUMBER GENERATED BY DEFAULT AS IDENTITY,
    SERVICE_NAME VARCHAR2(35) NOT NULL,
    SERVICE_DURATION NUMBER(2) NOT NULL,
    SERVICE_PRICE NUMBER(5, 2) NOT NULL,
    SERVICE_MATERIALS VARCHAR2(35) NOT NULL,
    CONSTRAINT SERVICE_PK PRIMARY KEY (SERVICE_ID)
);

INSERT INTO SALON_SERVICE(
    SERVICE_NAME,
    SERVICE_DURATION,
    SERVICE_PRICE,
    SERVICE_MATERIALS
) VALUES(
    'Trimming',
    30,
    50,
    'Scissors, comb'
);

INSERT INTO SALON_SERVICE(SERVICE_NAME, SERVICE_DURATION, SERVICE_PRICE, SERVICE_MATERIALS)
    VALUES('Women Haircut', 60, 30, 'Scissors, comb, brush');
INSERT INTO SALON_SERVICE(SERVICE_NAME, SERVICE_DURATION, SERVICE_PRICE, SERVICE_MATERIALS)
    VALUES('Men haircut', 20, 10, 'razor, buzzer');
INSERT INTO SALON_SERVICE(SERVICE_NAME, SERVICE_DURATION, SERVICE_PRICE, SERVICE_MATERIALS)
    VALUES('Dye', 80, 60, 'Hair dye, brush, timer');
INSERT INTO SALON_SERVICE(SERVICE_NAME, SERVICE_DURATION, SERVICE_PRICE, SERVICE_MATERIALS)
    VALUES('Clean shave', 20, 25, 'Shaving cream, razor');
INSERT INTO SALON_SERVICE(SERVICE_NAME, SERVICE_DURATION, SERVICE_PRICE, SERVICE_MATERIALS)
    VALUES('Full treatment', 60, 80, 'Special oil');

-- Create table for salon_appointment
CREATE TABLE SALON_APPOINTMENT (
    APPOINTMENT_ID NUMBER GENERATED BY DEFAULT AS IDENTITY,
    STATUS VARCHAR2(10) DEFAULT('pending'),
    APPROVED NUMBER(1) DEFAULT(1),
    DATE_APPOINTMENT DATE DEFAULT SYSDATE,
    CLIENT_ID NUMBER NOT NULL,
    PROFESSIONAL_ID NUMBER NOT NULL,
    SERVICE_ID NUMBER NOT NULL,
    SLOT VARCHAR2(10) DEFAULT ('9-10'),
    VENUE VARCHAR2(20) DEFAULT ('cmn_room'),
    CLIENT_NAME VARCHAR2(100) NOT NULL,
    PROFESSIONAL_NAME VARCHAR2(100) NOT NULL,
    SERVICE_NAME VARCHAR2(100) NOT NULL,

    CONSTRAINT APPOINTMENT_PK PRIMARY KEY (APPOINTMENT_ID),
    CONSTRAINT APPOINTMENT_CLIENTFK FOREIGN KEY (CLIENT_ID) REFERENCES SALON_USER(USER_ID),
    CONSTRAINT APPOINTMENT_PROFESSIONALFK FOREIGN KEY (PROFESSIONAL_ID) REFERENCES SALON_USER(USER_ID),
    CONSTRAINT APPOINTMENT_SEVICEFK FOREIGN KEY (SERVICE_ID) REFERENCES SALON_SERVICE(SERVICE_ID)
);

-- Create table for salon_report
CREATE TABLE SALON_REPORT(
    REPORT_ID NUMBER GENERATED BY DEFAULT AS IDENTITY,
    USER_ID NUMBER NOT NULL,
    APPOINTMENT_ID NUMBER NOT NULL,
    DATE_REPORT DATE DEFAULT SYSDATE,
    TITLE VARCHAR2(50) NOT NULL,
    CLIENT_REPORT VARCHAR2(500),
    PROFESSIONAL_REPORT VARCHAR2(500),
    CONSTRAINT REPORT_PK PRIMARY KEY (REPORT_ID),
    CONSTRAINT REPORT_FK FOREIGN KEY (APPOINTMENT_ID) REFERENCES SALON_APPOINTMENT(APPOINTMENT_ID),
    CONSTRAINT REPORT_USER_FK FOREIGN KEY (USER_ID) REFERENCES SALON_USER(USER_ID)
);

INSERT INTO SALON_USER(user_type, username, full_name, email, user_image, PASSWORD_HASHED, address, age)
    VALUES('admin_super','nasr', 'ADMIN SUPER', 'admin@gmail.com', 
            'default.png', '$2b$12$xmVAPgK1vQCmkIKaH.jxfubAjtbP2pL/tDKVj2qAHfnAiz2MT.S/e',
            '5000 hair street', '100');

